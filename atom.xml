<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[My Octopress Blog]]></title>
  <link href="http://peteonrails.github.com/atom.xml" rel="self"/>
  <link href="http://peteonrails.github.com/"/>
  <updated>2013-02-12T16:01:54-05:00</updated>
  <id>http://peteonrails.github.com/</id>
  <author>
    <name><![CDATA[Your Name]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[My Review of Metolius Porta-Cord Rope Bag]]></title>
    <link href="http://peteonrails.github.com/blog/2011/08/02/my-review-of-metolius-porta-cord-rope-bag/"/>
    <updated>2011-08-02T00:00:00-04:00</updated>
    <id>http://peteonrails.github.com/blog/2011/08/02/my-review-of-metolius-porta-cord-rope-bag</id>
    <content type="html"><![CDATA[<div class="hreview"><div class="item"><p><a href="http://www.rei.com/mp/rc/product/767279">Originally submitted at REI</a></p><div><img src="http://images.powerreviews.com/images_products/09/41/1700774_100.jpg" class="photo" align="left" style="margin: 0 0.5em 0 0"><p style="margin-top:0">Metolius Porta-Cord™ rope bag can also be used as a lightweight pack or a rope bucket during long multipitch routes and big-wall climbs.</p></div><a href="http://www.rei.com/mp/rc/product/767279" style="display: none;" class="url fn"><span class="fn">Metolius Porta-Cord Rope Bag</span></a></div><br clear="left"><p><strong class="summary">Better than a rope bag. Not a crag pack.</strong></p><div>By <strong>Pete Jackson</strong> from <strong>Rumney, NH</strong> on <strong><abbr title="201182T1200-0800" class="dtreviewed" style="border: none; text-decoration: none;">8/2/2011</abbr></strong></div><p><div style="margin: 0.5em 0; height: 15px; width: 83px; background-image: url(http://images.powerreviews.com/images/stars_small.gif); background-position: 0px -108px;" class="prStars prStarsSmall">&nbsp;</div></p><div style="display: none"><span class="rating">3</span>out of 5</div><p><strong>Pros: </strong>Wear Resistant</p><p><strong>Cons: </strong>Small Compartments</p><p><strong>Best Uses: </strong>Sport Climbing, Cragging</p><p><strong>Describe Yourself: </strong>Avid Climber</p><p><strong>Was this a gift?: </strong>No</p><p style="margin-top:1em" class="description">I really wanted to love this pack. To that end, I used it for a full season before returning it to try a better pack. <br xmlns:pr="xalan://com.pufferfish.core.beans.xmlbuilders.xsl.Functions"><br>This pack is, hands-down, better than any rope bag available. If you&#8217;re replacing a rope bag, or avoiding buying one, this is a great way to go. <br><br>That said, it&#8217;s a pretty bad pack. I found the straps uncomfortable, the lid hard to close when overstuffed, and the side pockets useless for holding anything when carrying a rope longer than 50M. <br><br>Unless you&#8217;re carrying a super-skinny rope or a 50M sub-10mm rope, you&#8217;re going to have trouble closing the pack, taking other gear with you, getting anything into those side pockets, and difficulty getting the load to ride correctly. <br><br>Also, I find those gear lashing daisy chains overrated. If you clip your shoes, harness, helmet, or water bottle to the outside of this pack, you&#8217;ll suffer from an unstable load that snags on trail obstacles. Not ideal. <br><br>I live in Rumney NH, exactly 3/4 mile from the crags, and I&#8217;d avoid taking this pack to the cliffs. Instead, I found myself favoring my hiking pack: so I knew something was wrong. <br><br>If you have short approaches, a short rope, not a lot of personal gear, and don&#8217;t mind the minimal padding on the straps, then this is an excellent pack. <br><br>If you are looking for a rope bag and can have your partner carry the rack, food, and water, then this is the pack for you. <br><br>Otherwise, it may not be.</p><p style="margin-top:0.5em">(<a href="http://www.powerreviews.com/legal/terms_of_use.html" rel="license">legalese</a>)</p></div>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Intro to Spatial Programming]]></title>
    <link href="http://peteonrails.github.com/blog/2010/07/09/intro-to-spatial-programming/"/>
    <updated>2010-07-09T00:00:00-04:00</updated>
    <id>http://peteonrails.github.com/blog/2010/07/09/intro-to-spatial-programming</id>
    <content type="html"><![CDATA[My slides from the presentation &#8220;Intro to Spatial Programming&#8221; are now available. You can download them as:
<ul>
	<li>A 20MB <a href="http://blog.peteonrails.com/wp-content/uploads/2010/07/Intro%20to%20Spatial%20Programming.key">Keynote &#8216;o9 file</a></li>
	<li>A 10MB <a href="http://blog.peteonrails.com/wp-content/uploads/2010/07/Intro%20to%20Spatial%20Programming.pdf">PDF file</a> (transitions and animations will not work)</li>
	<li>A 52MB <a href="http://blog.peteonrails.com/wp-content/uploads/2010/07/Intro%20to%20Spatial%20Programming%20-%20Full.mov">Quicktime Movie ar 1024x768 </a></li>
	<li>A 9.1MB <a href="http://blog.peteonrails.com/wp-content/uploads/2010/07/Intro%20to%20Spatial%20Programming.mov">Quicktime Movie formatted for the iPod and iPad </a>(640x480)</li>
</ul>
I hope you enjoy the slides. If you missed my talk and want me to present the material at your Ruby User Group, contact me.

All presentation material is Copyright 2010 Peter Jackson, licensed under CC 3.0 Attribution. You can reused, redistribute, and remix the content. Just make sure you attribute it with a link.

Enjoy!
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[The Revenge of Inigo Montoya]]></title>
    <link href="http://peteonrails.github.com/blog/2010/05/25/the-revenge-of-inigo-montoya/"/>
    <updated>2010-05-25T00:00:00-04:00</updated>
    <id>http://peteonrails.github.com/blog/2010/05/25/the-revenge-of-inigo-montoya</id>
    <content type="html"><![CDATA[<pre lang='ruby'>
:false
</pre>

You keep using that symbol. I do not think it means what you think it means. 

Today, I&#8217;d like to describe something I like to call: <strong>The Inigo Montoya Attack</strong>. It is the implementation in code &#8211; often with good intentions, but sometimes simply because of ignorance &#8211; of an algorithm which masks one clear, well-known paradigm inside of another that completely obfuscates your actual intent.  Unless you have six-fingers on your right hand (I&#8217;m talking to YOU, <a href="http://en.wikipedia.org/wiki/Count_Rugen">Count Rugen</a>) you are forbidden from this practice. 

Here&#8217;s some code I came across in a codebase I was maintaining. 

<pre lang='ruby'>
 def logged_in_from_token?
    current_user = token_exists? ? log_in_from_token : :false
 end
</pre>

It looks strange. It OUGHT to look strange. What is that :false symbol all about? 

I&#8217;ll tell you what it is. It&#8217;s a very misleading piece of code. Because when you do not log the user in from a token, current_user is NOT set to false, in the boolean sense. It is, in fact, a boolean &#8220;true&#8221; value in Ruby. 

Try this in IRB: 

<pre lang='ruby'>
 if :false  
   puts "You keep using that word. I do not think it means what you think it means." 
else 
  puts "Have fun storming the castle!"
end
</pre>

If <em><strong>:false</strong></em> evaluated to a <em>boolean false</em> value, then you&#8217;d see &#8220;Have fun storming the castle!&#8221;. But instead, you get &#8220;You keep using that word. I do not think it means what you think it means.&#8221; If you&#8217;re trying to make readable code, using the symbol <em><strong>:false</strong></em> is dangerous and misleading. 

To make matters worse, this code assigns <em><strong>:false</strong></em> to the value <strong>current_user</strong>, which is a well-known and established name used in a number of Rails patterns. RESTFul Authentication and Authlogic BOTH support the notion of <strong>current_user</strong>, and when nobody is logged in, THAT METHOD RETURNS FALSE. Not the doppleganger wannabe <em><strong>:false</strong></em>, but a real, honest to goodness, <em>boolean false</em>. (OK: it&#8217;s actually returning nil, but nil is false). 

So imagine my bewilderment when this basic test no longer worked: 

<pre lang='ruby'>
  <%- if current_user %>
    <%= display_logged_in_stuff()  %>
  <% else %>
      You are not logged in
   <% end %>
</pre>

So a couple hours of debugging later, I found myself using &#8216;ack in project&#8217; to remove all references to the silly symbol <em><strong>:false</strong></em>. 

Lessons for Rubyists: 
<ol>
	<li>Be clear. :false is never actually false. Don&#8217;t use it. </li>
	<li>Follow established conventions. The method <strong>some_test?</strong> should always return a boolean value. If it doesn&#8217;t, leave off the question mark!</li>
 	<li>Don&#8217;t reinvent the wheel! The implementor of the code above could have simply used RESTful Authentication or Authlogic and have avoided the whole mess. </li>
	<li>Unit tests are still important! Remember that someone has to maintain your stuff someday. A simple unit test would have caught the bug introduced by using the symbol <strong>:false</strong> in place of a <em><strong>boolean false</strong></em>.</li>
</ol>

Have fun storming the castle!



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Oracle Spatial support in spatial_adapter for ActiveRecord]]></title>
    <link href="http://peteonrails.github.com/blog/2010/04/14/oracle-spatial-support-in-spatial_adapter-for-activerecord/"/>
    <updated>2010-04-14T00:00:00-04:00</updated>
    <id>http://peteonrails.github.com/blog/2010/04/14/oracle-spatial-support-in-spatial_adapter-for-activerecord</id>
    <content type="html"><![CDATA[I&#8217;ve recently made public the first cut of functionality for Oracle Spatial support in Fragility&#8217;s <a href="http://github.com/peteonrails/spatial_adapter" target="_blank">Spatial Adapter for ActiveRecord</a>. It&#8217;s not ready for prime time, but it&#8217;s useful enough to open up to collaboration. As soon as I finish up complete spec tests and a couple of refactorings, I plan to issue a pull request and get the functionality included in the main fork of spatial_adapter on Github.

I won&#8217;t go too far into how to use the adapter until it&#8217;s ready for prime time. This message is intended to encourage collaboration among anyone else who is in the unfortunate boat of having to use Oracle Spatial and Rails without built in driver support (which is not fun).

To use the functionality, <a href="http://blog.rayapps.com/2009/09/14/how-to-install-oracle-database-10g-on-mac-os-x-snow-leopard/">install Oracle</a>, <a href="http://rubyforge.org/projects/georuby/">Install GeoRuby </a>, then install <a href="http://github.com/peteonrails/spatial_adapter">my fork of the spatial_adapter</a>.

Then you can do this:

<pre lang="ruby">
   create_table :points_of_interest do |t|
      t.geometry :location
      t.string :venue_name 
      t.timestamps
   end
 
   add_index :points_of_interest, [:location], :spatial => true

</pre>

Then all of the relevant rows will be set up for you in SDO_GEOM_METADATA, SDO_INDEX_METADATA, and SDO_INDEX_METADATA_TABLE. 

Currently, there is only support for geometry types. Explicit point, polygon, line, and multipolygon types will come later. 

Feedback is encouraged.

<em>P.S. To everyone wondering what happened to the VoteFu major upgrade, it&#8217;s imminent. Thanks to everyone who has submitted patches in the past few months. It&#8217;ll be released *real soon now*</em>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Goodbye TextMate]]></title>
    <link href="http://peteonrails.github.com/blog/2010/03/26/goodbye-textmate/"/>
    <updated>2010-03-26T00:00:00-04:00</updated>
    <id>http://peteonrails.github.com/blog/2010/03/26/goodbye-textmate</id>
    <content type="html"><![CDATA[I&#8217;ve been using TextMate to develop Ruby on Rails applications for a very long time. But as of today, I&#8217;m abandoning TextMate. And <a href="http://pivotallabs.com/users/alex/blog/articles/1201-textmate-the-last-straw">I&#8217;m not the only one.</a>

For me, the last straw with TextMate was the issue illustrated<a href="http://blog.peteonrails.com/wp-content/uploads/2010/03/iShowU-Capture2.mov"> in this video</a>. When you have all of your methods folded up, and you delete a line of whitespace that follows a folded up block of code, the editor will in fact delete the entire folded up code block. This might be working as expected, but I expect better.

Some other annoyances I&#8217;ve had with TextMate include:
<ul>
	<li>Random Pinwheeling (lockups that take unspecified amounts of time to clear)</li>
	<li>Sluggish performance</li>
	<li>Drawer behavior: When I want it on the left, I want it on the left. Even if my window is too close to the left side of my monitor. STOP OPENING ON THE RIGHT! DO YOU HEAR ME! (excerpt from an actual conversation with TextMate).</li>
	<li>No significant updates in over two years. Not even the kind you pay for.  I guess the upside of this is that any Bundles you find are pretty well guaranteed to work with your version of TextMate, because there&#8217;s really only one version.</li>
</ul>
After making the decision that I couldn&#8217;t continue to work in a professional setting with an editor that contains so many productivity-sapping limitations for me, I decided to switch.

I found that in making my list of requirements for a replacement editor, the beginning of it was an enumeration of what sucks about TextMate. I needed:
<ol>
	<li> Fast Search in Project</li>
	<li> Fast &#8220;Find Usages&#8221;</li>
	<li> A lack of code-munching bugs.</li>
</ol>
But  there are a lot of things that I like about TextMate. I wanted to keep those features too:
<ol>
	<li>Autosave</li>
	<li>Fuzzy Match</li>
	<li>Strong Ruby Language Support</li>
	<li>HAML and SASS support</li>
	<li>Modules / Plugins / Bundles</li>
	<li>No Crashing</li>
	<li>Themes and control over colorization</li>
</ol>
First, I checked out <a href="http://www.jetbrains.com/ruby/index.html">RubyMine</a>, but found that it crashed and froze on me a lot. I can&#8217;t have a code editor that crashes or freezes a lot. Alex Chaffee of Pivotal Labs likes RubyMate, however, so your mileage may vary. It&#8217;s worth checking out. <a href="http://www.jetbrains.com/ruby/download/index.html">And you can check it out for free</a>.

Next I investigated <a href="http://www.panic.com/coda/">Coda</a>: it&#8217;s pretty, but doesn&#8217;t have a made-for-ruby feel to it. It&#8217;s got a very extensible plugin framework, and a lot of plugins made for it, but a couple of key plugins were missing, and I can&#8217;t afford to take the time to write the plugins right now.

Then I tried BBEdit: nice, but again: not enough support through plugins for the kinds of ruby development I do.

Then MacVim: which is awesome but I HATE &#8216;vi&#8217; (if I&#8217;m going to use a UNIX editor for programming, it&#8217;s going to be emacs).

Finally, I decided to try <a href="http://netbeans.org/">NetBeans</a>, and found everything I needed, and some stuff I didn&#8217;t even KNOW I needed. I was genuinely surprised that I liked NetBeans, given its background as a Java IDE. But the Ruby modules for Netbeans are very nice. Here&#8217;s what I liked the most, in no particular order:
<ul>
	<li>Autotest, running right in the IDE: I don&#8217;t have to remember to start it in a terminal. It just runs in my IDE.</li>
	<li>Search. It&#8217;s Fast. And I didn&#8217;t have to install Ack In Project to make it so.</li>
	<li>When my continuous integration build fails, my IDE is notified, and it tells me so.</li>
	<li>It integrates with bug trackers.</li>
</ul>
Aside from the &#8220;search&#8221; item, I didn&#8217;t even know I needed half of that stuff. But now that I have it, I can&#8217;t go back.

I still use TextMate for a basic editor, and still love the column-wise cut-and-paste feature. But I won&#8217;t use it for development anymore.

So long, TextMate. It&#8217;s been a ride.
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[New Rails Plugin Available: YAML Twitter OAuth]]></title>
    <link href="http://peteonrails.github.com/blog/2009/11/17/new-rails-plugin-available-yaml-twitter-oauth/"/>
    <updated>2009-11-17T00:00:00-05:00</updated>
    <id>http://peteonrails.github.com/blog/2009/11/17/new-rails-plugin-available-yaml-twitter-oauth</id>
    <content type="html"><![CDATA[When I build Twitter OAuth apps, I usually register three apps. One for development purposes, one for staging and user-acceptance testing, and the production application. Each of these registered apps will have a different Twitter OAuth Consumer Token and Secret. Instead of writing procedural code to set the right tokens up for each environment, or setting them in the various environment/*.rb files, I prefer to set them up declaratively like you do in database.yml.

I&#8217;ve extracted the basic code i use to do this and published it as a simple plugin called <a title="yaml_twitter_oauth" href="http://github.com/peteonrails/yaml_twitter_oauth">yaml_twitter_oauth</a>.

It allows you to set up your consumer tokens like this:
<pre lang="yaml">defaults: &defaults
  request_token_url: http://twitter.com/oauth/request_token
  access_token_url: http://twitter.com/oauth/access_token
  authorize_url: http://twitter.com/oauth/authorize

development:
  <<: *defaults
  consumer_key: 12345678
  consumer_secret: this-is-your-application-secret

staging:
  <<: *defaults
  consumer_key: 12345678
  consumer_secret: this-is-your-application-secret

production:
  <<: *defaults
  consumer_key: 12345678
  consumer_secret: this-is-your-application-secret
</pre>

It&#8217;s also useful if you want to regenerate your secret key and need a simple declarative way to update it. 

To install the plugin: 

<pre lang="bash">
 script/plugin install git://github.com/peteonrails/yaml_twitter_oauth.git
</pre> 

Enjoy! 
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[VoteFu is now available on GemCutter]]></title>
    <link href="http://peteonrails.github.com/blog/2009/11/14/votefu-is-now-available-on-gemcutter/"/>
    <updated>2009-11-14T00:00:00-05:00</updated>
    <id>http://peteonrails.github.com/blog/2009/11/14/votefu-is-now-available-on-gemcutter</id>
    <content type="html"><![CDATA[<img class="alignright size-thumbnail wp-image-195" title="gem" src="http://blog.peteonrails.com/wp-content/uploads/2009/11/gem-150x150.jpg" alt="gem" width="150" height="150" />@alexanderkahn asked me via <a class="zem_slink" title="Twitter" rel="homepage" href="http://twitter.com/">Twitter</a> whether I&#8217;d be pushing VoteFu to GemCutter. To tell you the truth, I hadn&#8217;t really thought about it. But, it does seem to be what all the cool kids are doing.

Want to see how easy it was to move to GemCutter?
<pre lang="bash">ping:$ sudo gem install gemcutter
Password:

========================================================================

           Thanks for installing Gemcutter! You can now run:

    gem tumble        use Gemcutter as your primary RubyGem source
    gem push          publish your gems for the world to use and enjoy
    gem migrate       take over your gem from <a class="zem_slink" title="RubyForge" rel="homepage" href="http://rubyforge.org/">RubyForge</a> on Gemcutter
    gem owner         allow/disallow others to push to your gems

========================================================================

Successfully installed gemcutter-0.1.6
1 gem installed
Installing ri documentation for gemcutter-0.1.6...
Installing RDoc documentation for gemcutter-0.1.6...
ping: Pete$ gem tumble
Thanks for using Gemcutter!
Your gem sources are now:
- http://gemcutter.org
- http://gems.rubyforge.org
- http://gems.github.com
ping:workspace Pete$ cd vote_fu_harness/vendor/plugins/vote_fu/
ping:vote_fu Pete$ ls
CHANGELOG.markdown      README.markdown         examples                init.rb                 rails                   test
MIT-LICENSE             db                      generators              lib                     spec                    vote_fu.gemspec
ping:vote_fu Pete$ gem build vote_fu.gemspec
WARNING:  no rubyforge_project specified
  Successfully built RubyGem
  Name: vote_fu
  Version: 0.0.11
  File: vote_fu-0.0.11.gem
ping:vote_fu Pete$ gem push vote_fu-0.0.11.gem
Enter your Gemcutter credentials. Don't have an account yet? Create one at http://gemcutter.org/sign_up
Email:   pete@peteonrails.com
Password:
Signed in. Your api key has been stored in ~/.gemrc
Pushing gem to Gemcutter...
Successfully registered gem: vote_fu (0.0.11)
ping:vote_fu Pete$</pre>
Scarily easy. In under 3 minutes I have a new primary gem source and am set up to publish to GemCutter.

So, why would one want o host Gems on GemCutter? I asked the same question. In a nutshell:
<ol>
	<li>Download counts are shown inline</li>
	<li>Build locally, then push-to-publish. No more waiting to make your way through DJ, BJ, Resque, or whatever the background framework of the day is at <a class="zem_slink" title="GitHub" rel="homepage" href="http://github.com">GitHub</a>.</li>
	<li>It&#8217;s nothing but gem hosting, so it&#8217;ll probably grow to do gem hosting really well.</li>
	<li>It&#8217;s ThoughtBot. I like the ThoughtBot guys.</li>
</ol>
So, there&#8217;s no real compelling reason to run out and move your gems to GemCutter, but if your users ask you to do it, it takes 3 minutes or less.
<div class="zemanta-pixie" style="margin-top: 10px; height: 15px;"><a class="zemanta-pixie-a" title="Reblog this post [with Zemanta]" href="http://reblog.zemanta.com/zemified/a240f45a-6168-42d3-808c-922211278fb5/"><img class="zemanta-pixie-img" style="border: none; float: right;" src="http://img.zemanta.com/reblog_e.png?x-id=a240f45a-6168-42d3-808c-922211278fb5" alt="Reblog this post [with Zemanta]" /></a><span class="zem-script more-related pretty-attribution"><script src="http://static.zemanta.com/readside/loader.js" type="text/javascript"></script></span></div>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How I became convinced to use db:populate instead of db:migrate with inline data seeding, and why you should too.]]></title>
    <link href="http://peteonrails.github.com/blog/2009/11/11/how-i-became-convinced-to-use-dbpopulate-instead-of-dbmigrate-with-inline-data-seeding-and-why-you-should-too/"/>
    <updated>2009-11-11T00:00:00-05:00</updated>
    <id>http://peteonrails.github.com/blog/2009/11/11/how-i-became-convinced-to-use-dbpopulate-instead-of-dbmigrate-with-inline-data-seeding-and-why-you-should-too</id>
    <content type="html"><![CDATA[<img class="alignright size-thumbnail wp-image-178" title="iStock_000002051165XSmall" src="http://blog.peteonrails.com/wp-content/uploads/2009/11/iStock_000002051165XSmall-150x150.jpg" alt="iStock_000002051165XSmall" width="150" height="150" />There&#8217;s a lot of established debate and best practice around how to populate your database with the initial reference data it needs in order to operate. I&#8217;m not going to rehash that here. If you&#8217;re interested in the options available for seeding data, <a href="http://railspikes.com/2008/2/1/loading-seed-data">read Luke Franci&#8217;s article on Rails Spikes.</a> Many people I work with seem to like &#8220;db:populate&#8221; which, while very nice and flexible, always seemed like a little bit of overkill to me.

I was always in favor of seeding short reference data right in the migration like this:
<pre lang="ruby">class CreateTestScopes < ActiveRecord::Migration
  def self.up
    create_table :test_scopes do |t|
      t.string  :name
      t.timestamps
    end

    %w(first second third).each do |e|
       TestScope.create(:name => e)
     end
  end

  def self.down
    drop_table :test_scopes
  end

end</pre>
JUST TO BE CLEAR: we&#8217;re talking about production reference data that the application requires in order to run. We are not talking about TEST data, which belongs in mocks or (gasp) fixtures. A really good example of legitimate production seed data is the creation of the out-of-box Administrative user.

And if I had to update my reference data, I was also a fan of including it in the migration. After all, it&#8217;s reference data, not test data, fixture data (eww!) or user data.
<pre lang="ruby">class CapitalizeTestScopes < ActiveRecord::Migration
  def self.up
    TestScope.all.each { |t| t.name = t.name.capitalize; t.save! }
  end

  def self.down
    puts "Can't undo, but don't freak out!"
  end
end</pre>
Later, I decided I wanted a sort-order column and decided to add something like this:
<pre lang="ruby">class AddSortOrderToTestScopes < ActiveRecord::Migration
  def self.up
    add_column :test_scopes, :sort_order, :integer
  end
  # omit self.down ....
end

class TestScope &lt; ActiveRecord::Base
  default_scope :order => "sort_order"
end</pre>
And here&#8217;s the crux of the issue:

By adding a column that the model depends on in the default_scope, we&#8217;ve made it a requirement for the sort_order column to be present in order to load and query the model object. That&#8217;s fine for me. This migration will run with no errors on my workstation, provided that I ran db:migrate immediately prior to my latest changeset.

However, if you want to come up to speed on my project, you cannot do this:
<pre lang="bash"> bash# rake db:setup
 bash# rake db:migrate</pre>
Because here&#8217;s what will happen:
<pre lang="bash">==  CapitalizeTestScopes: migrating ===========================================
rake aborted!
An error has occurred, this and all later migrations canceled:

SQLite3::SQLException: no such column: sort_order: SELECT * FROM "test_scopes"  ORDER BY sort_order</pre>
Since we&#8217;re using the ActiveRecord object to do our reference updates (which is A GOOD THING, since we get validations and abbreviated syntax), we can&#8217;t have dependencies in the default scope that are not defined before the first use of the ActiveRecord object in our migrations.

A lot of folks argue that migrations are not reliable and shouldn&#8217;t be the way you&#8217;re creating your schema in the first place. To that, I respectfully say, &#8220;You&#8217;re wrong.&#8221;

It is only because we developers make boneheaded mistakes like the one outlined above that we cannot rely on migrations to rebuild our schema incrementally from migrations. Rather than be boneheaded, we should <strong>be awesome instead</strong> and fix the migration dependencies by moving the data seeding out to a db:populate or other rake task that operates on a completely built data structure. (I know: this is not in line with the movement toward schema.rb as the authoritative source of the database structure. I&#8217;m not up for arguing that point today, but I will argue it.)

The answer is to do this:
<pre lang="ruby"># file: db/migrate/X_create_test_scopes.rb
class CreateTestScopes < ActiveRecord::Migration
  def self.up
    create_table :test_scopes do |t|
      t.string  :name
      t.timestamps
    end
  end

  def self.down
    drop_table :test_scopes
  end
end

# File: db/populate/001_seed_scopes.rb
%w(first second third).each do |e|
   TestScope.create(:name => e)
 end</pre>
Then, when you have to capitalize your model data:
<pre lang="ruby"># File: db/populate/002_capitalize_scopes.rb
TestScope.all.each { |t| t.name = t.name.capitalize; t.save! }</pre>
And then when you add the sort order:
<pre lang="ruby">class AddSortOrderToTestScopes < ActiveRecord::Migration
  def self.up
    add_column :test_scopes, :sort_order, :integer
  end
  # omit self.down ....
end

class TestScope < ActiveRecord::Base
  default_scope :order => "sort_order"
end

# file db/populate/003_seed_sort_order.rb
TestScope.each_with_index { |e, i| e.sort_order = i; e.save! }</pre>
Voila! You can run db:migrate with a fresh database and have no errors.

So far, when I encounter an issue that prevents me from rebuilding my complete schema incrementally using db:migrate, it&#8217;s been a Rails Smell. I haven&#8217;t found a legitimate reason why migrations can&#8217;t be sorted out to build cleanly every time. If you can&#8217;t rebuild your database incrementally using migrations, it&#8217;s likely that you&#8217;re doing something wrong.

I ignored this debate for a long time because it didn&#8217;t really affect me. Don&#8217;t be like me. Save yourself the trouble of unwinding your migration mess and use an outside seeding package like db:populate.
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[MyQuotable source code available again]]></title>
    <link href="http://peteonrails.github.com/blog/2009/04/03/myquotable-source-code-available-again/"/>
    <updated>2009-04-03T00:00:00-04:00</updated>
    <id>http://peteonrails.github.com/blog/2009/04/03/myquotable-source-code-available-again</id>
    <content type="html"><![CDATA[I took the MyQuotable example code down from github for a little while because I&#8217;d hosed it up trying to convert it into a facebook application. A few users have emailed me in the past month or so asking where the code is located. 

I&#8217;ve just republished the source code, so you can again download my example application for VoteFu. 


]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Why Rails Developers are at such peace with the world.]]></title>
    <link href="http://peteonrails.github.com/blog/2009/03/16/why-rails-developers-are-at-such-peace-with-the-world/"/>
    <updated>2009-03-16T00:00:00-04:00</updated>
    <id>http://peteonrails.github.com/blog/2009/03/16/why-rails-developers-are-at-such-peace-with-the-world</id>
    <content type="html"><![CDATA[<img class="aligncenter size-full wp-image-169" title="Girl working with laptop in a flowering field" src="http://blog.peteonrails.com/wp-content/uploads/2009/11/iStock_000004133301XSmall.jpg" alt="Girl working with laptop in a flowering field" width="425" height="282" />

Because they already know the answer to the burning theological question that has ignited fury around the globe for thousands of years.
<pre lang="bash">[pete@me.local log]$ which god
/usr/local/bin/god</pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[The Case for Story Points]]></title>
    <link href="http://peteonrails.github.com/blog/2009/02/05/the-case-for-story-points/"/>
    <updated>2009-02-05T00:00:00-05:00</updated>
    <id>http://peteonrails.github.com/blog/2009/02/05/the-case-for-story-points</id>
    <content type="html"><![CDATA[Scrum Masters embarking on a project or converting a team from conventional development to Scrum often run into one big roadblock: convincing the stakeholders to use Agile Estimation techniques. One of the most important and success-inducing things you can do when estimating an Agile project is to abandon the &#8220;hour&#8221; as the unit of estimation in favor of &#8220;story points&#8221;.

The idea is, instead of using &#8220;hours&#8221; to estimate how long a story will take to complete, you instead have the team use an arbitrary figure called a &#8220;story point&#8221;. So, a new input field on a web page might be &#8220;1 point&#8221;. A new login screen is probably &#8220;3 points&#8221;. And adding a new payment gateway may be &#8220;8 points&#8221;.

Each iteration will then have a point value assigned to it. For example, Iteration 6 may be &#8220;23 points&#8221;. When your team completes all of the functionality, the team&#8217;s velocity is &#8220;23 story points per iteration&#8221;. Savvy Scrum Masters will calculate Velocity as the moving average of the last 4 iterations.

Why bother ditching the &#8220;hour&#8221;? Here&#8217;s why:
<ol>
	<li> It eliminates preconceived notions about how much code can be written in a day.</li>
	<li>It eliminates the &#8220;Day&#8221; as an important unit of measure.</li>
	<li>It forces you to forecast completion of your project based on evidence. If you estimate in hours, you&#8217;re already forecasting. If you estimate in points, you&#8217;re simply measuring complexity in relative terms and relying on past performance to predict future results. In software, that&#8217;s a good thing.</li>
	<li>It helps to gel the team. If Joe can do a feature in 8 hours, and Eric can do that same feature in 12 hours, there&#8217;s going to be a disagreement on how much to estimate. Instead, shouldn&#8217;t Joe and Eric agree that &#8220;Two new fields on the screen is twice as big as one new field on the screen?&#8221; Over time, the difference in coding productivity between your team members will be abstracted away by the estimation technique, which allows each team member to play to their own strengths without being measures in widgets-per-hour.</li>
	<li>It ends up being more accurate after 2 or 3 iterations.</li>
	<li>It avoids the mythical man month problem. By insisting that you forecast based on evidence, a manager cannot offer to double the team size and cut the deadline in half.</li>
</ol>
There are lots more benefits. There are books full of the benefits. Read them.

In convincing stakeholders to allow the engineering team to use Story Points, I have run into several objections. Here they are, along with the answers that I use.

<strong>Objection: </strong>But if your numbers don&#8217;t map to hours, how do I know how long something will take?

<strong>Answer:</strong> You use Velocity, as calculated by the evidence of progress your team produces, and map target dates based on what actually happened instead of a gut feeling.

<strong>Objection:</strong> But then how do you know how much more you can get done by adding more resources to the project?

<strong>Answer:</strong> Again, you use the evidence. Adding a new team member doesn&#8217;t immediately produce a faster tempo on a project. There is no way to know how a new team member will contribute to a self-organizing team until you see them perform. As that team member ramps up, the team will eventually start producing more story points per iteration. You will only take on work in a sprint that you historically could complete, and as you start completing all of the committed work faster, your velocity increases. The team is continually winning instead of lagging. If you instead use &#8220;hours&#8221; to estimate, you&#8217;d be tempted to just add &#8220;40 hours&#8221; to the velocity. That&#8217;s a guess, and it&#8217;ll be wrong every time.

<strong>Objection</strong>: But then how do I calculate what a project costs me?<strong></strong>

<strong>Answer</strong>: If you have all of the members of a Scrum team properly allocated, and you have an accurate forecast of the completion date, then you can easily calculate the project labor cost using very simple math. If you use hours instead, you use the same simple math, it&#8217;ll just be inaccurate.

<strong>Objection:</strong> But then how do I know how much overtime to ask the developers to work in order to meet my deadlines?

<strong>Answer:</strong> Forcing overtime to meet deadlines is a Scrum Smell. It means you are planning poorly, sticking to unreasonable deadlines, sacrificing quality, or the team is failing because of some organizational, process, or performance issue. That said, it is sometimes necessary to work overtime. Rather than tell everyone they need to work 10 extra hours this week to make the deliverable, it&#8217;s actually BETTER to say to your team: &#8220;We have 10 more story points to complete in 2 days, and we&#8217;re only burning 3 points per day.&#8221; If the Scrum Master is good, the team will know what to do. And they&#8217;ll do it as a team.

Good luck! Let me know how it goes.
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[MyQuotable.com Source Code released]]></title>
    <link href="http://peteonrails.github.com/blog/2008/12/04/myquotablecom-source-code-released/"/>
    <updated>2008-12-04T00:00:00-05:00</updated>
    <id>http://peteonrails.github.com/blog/2008/12/04/myquotablecom-source-code-released</id>
    <content type="html"><![CDATA[A number of VoteFu users have asked me for help integrating VoteFu into their codebase. I recognize that this means I&#8217;ve probably left the documentation lacking in a couple of places, but in order to immediately help those folks who want a reference implementation of VoteFu, I am releasing the full source code of <a href="http://www.myquotable.com">MyQuotable.com</a>. 

MyQuotable was a fun distraction for me, but frankly, I really wrote it so I could have a POC application for VoteFu and a couple other plugins. it doesn&#8217;t have any particularly useful Intellectual Property and it&#8217;s not the Next Big Thing. So it doesn&#8217;t make sense to keep the source closed. 

You can get the <a href="http://github.com/peteonrails/myquotable/tree/master">source code from GitHub.</a>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Amusing Javascript Snippet]]></title>
    <link href="http://peteonrails.github.com/blog/2008/12/03/amusing-javascript-snippet/"/>
    <updated>2008-12-03T00:00:00-05:00</updated>
    <id>http://peteonrails.github.com/blog/2008/12/03/amusing-javascript-snippet</id>
    <content type="html"><![CDATA[I saw this posted on <a href="http://brighter.net">Jacqui Maher&#8217;s blog</a> today and was so amused I had to reblog it.
<pre lang="javascript">if (!(typeof worldHasEnded == "undefined")) {
   document.write("YUP.");
} else {
   document.write("NOPE.");
}</pre>
From <a href="http://hasthelargehadroncolliderdestroyedtheworldyet.com/"> http://hasthelargehadroncolliderdestroyedtheworldyet.com/</a>.

Aside from the very obvious &#8220;you don&#8217;t need to negate that test condition, just reverse your simple if and else clauses&#8221; issue, it&#8217;s quite amusing.

Clever. I like it.
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[VoteFu 0.0.7]]></title>
    <link href="http://peteonrails.github.com/blog/2008/12/02/votefu-007/"/>
    <updated>2008-12-02T00:00:00-05:00</updated>
    <id>http://peteonrails.github.com/blog/2008/12/02/votefu-007</id>
    <content type="html"><![CDATA[A couple of contributors forked VoteFu and submitted some patches. I&#8217;ve updated the master branch to integrate the changes. Notably:
<ul>
	<li>VoteFu now works as a standard gem in a Ruby application. (i.e. not as a Rails plugin)</li>
	<li>VoteFu now works as a Rails Gem Plugin.</li>
	<li>VoteFu now works with Rails 2.2.2.</li>
	<li>Other assorted small bugfixes.</li>
</ul>
To install VoteFu as a Gem Plugin:
<pre lang="bash">
sudo gem install peteonrails-vote_fu
</pre>
Then in config/environment.rb: 
<pre lang="ruby">
  config.gem "peteonrails-vote_fu", 
     :source => "http://gems.github.com", 
     :lib => "vote_fu"
</pre>
And then, optionally: 
<pre lang="bash">
rake gems:unpack
</pre>

Special thanks to Jon Maddox and Bence Nagy for the updated code. <a href="http://github.com/peteonrails/vote_fu/tree/master">Check it out yourself!</a>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Book musings: Ubuntu Kung Fu is released and other fun]]></title>
    <link href="http://peteonrails.github.com/blog/2008/09/24/book-musings-ubuntu-kung-fu-is-released-and-other-fun/"/>
    <updated>2008-09-24T00:00:00-04:00</updated>
    <id>http://peteonrails.github.com/blog/2008/09/24/book-musings-ubuntu-kung-fu-is-released-and-other-fun</id>
    <content type="html"><![CDATA[[caption id=&#8221;attachment_113&#8221; align=&#8221;alignnone&#8221; width=&#8221;190&#8221; caption=&#8221;Picture of a cute kitten attacking unseen prey&#8221;]<a href="http://blog.peteonrails.com/wp-content/uploads/2008/09/ktuk.jpg"><img class="size-medium wp-image-113" title="Ubuntu Kung Fu cover" src="http://blog.peteonrails.com/wp-content/uploads/2008/09/ktuk.jpg" alt="Picture of a cute kitten attacking unseen prey" width="190" height="228" /></a>[/caption]

I absolutely LOVE the <a href="http://www.pragprog.com/titles/ktuk/ubuntu-kung-fu">cover of this book</a>. And the book itself looks pretty decent, though how the author fills 300 pages with tricks and tips on Ubuntu it beyond me.

I&#8217;m not sure when it happened, but the technical world starting using amusing pictures of animals on the covers of their books some time in the late 1980s or early 1990s, and they seem to be the only ones I can remember. I&#8217;ll bet they typically sell well too.

The first book I can remember buying in this genre was the <a href="http://en.wikipedia.org/wiki/Programming_Perl">Pink Camel Perl book</a> in 1995 or so (it was published in 1991), with a picture of a camel on the front. This book proved to be a long-lived reference guide for me, and now I hold onto it for sentimental value. Interestingly enough, I&#8217;d never have been able to tell you the name of the book, which is &#8220;Programming Perl&#8221;. Here is a picture of it:

<a href="http://blog.peteonrails.com/wp-content/uploads/2008/09/9780937175644_cat.gif"><img class="alignnone size-medium wp-image-116" title="Programming Perl, 1st ed" src="http://blog.peteonrails.com/wp-content/uploads/2008/09/9780937175644_cat.gif" alt="" width="180" height="270" /></a>

<a href="http://blog.peteonrails.com/wp-content/uploads/2008/09/200px-programming_perl.jpg">
</a>

Oddly, O&#8217;Reilly kinda blew it with <a href="http://oreilly.com/catalog/9780596001841/">Ant: The Definitive Guide</a>. It has a picture of a lizard on the front. What&#8217;s that about? Wouldn&#8217;t you put a picture of an Ant on the cover of this book?

<a href="http://blog.peteonrails.com/wp-content/uploads/2008/09/0596001843_cat.gif"><img class="alignnone size-medium wp-image-117" title="Ant: The definitive guide" src="http://blog.peteonrails.com/wp-content/uploads/2008/09/0596001843_cat.gif" alt="" width="180" height="236" /></a>

Compare those three covers with these covers, from two of the most important and influential books in programming:

<a href="http://blog.peteonrails.com/wp-content/uploads/2008/09/2364f1.png"><img class="size-medium wp-image-119 alignright" title="2364f1" src="http://blog.peteonrails.com/wp-content/uploads/2008/09/2364f1.png" alt="" width="183" height="235" /></a><a href="http://blog.peteonrails.com/wp-content/uploads/2008/09/180px-kr_c_prog_lang.jpg"><img class="alignleft size-medium wp-image-118" title="180px-kr_c_prog_lang" src="http://blog.peteonrails.com/wp-content/uploads/2008/09/180px-kr_c_prog_lang.jpg" alt="" width="180" height="237" /></a>

Boring! But again, these are two very important books based on their content. Care to wager how the relative sales numbers of the Camel Book and K&amp;R look?
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[A rare post on politics]]></title>
    <link href="http://peteonrails.github.com/blog/2008/09/06/a-rare-post-on-politics/"/>
    <updated>2008-09-06T00:00:00-04:00</updated>
    <id>http://peteonrails.github.com/blog/2008/09/06/a-rare-post-on-politics</id>
    <content type="html"><![CDATA[I don&#8217;t like to write about politics. However, I am glad to see that <a href="http://political-fallout.blogspot.com/2008/01/obama-plagiarizes-bob-builder-in-nh.html">I am not the only one who</a> thinks of Bob the Builder every time I hear Barak Obama say, &#8220;Yes we can!&#8221;.
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Visualizing user interaction with your site.]]></title>
    <link href="http://peteonrails.github.com/blog/2008/09/04/visualizing-user-interaction-with-your-site/"/>
    <updated>2008-09-04T00:00:00-04:00</updated>
    <id>http://peteonrails.github.com/blog/2008/09/04/visualizing-user-interaction-with-your-site</id>
    <content type="html"><![CDATA[I really like the app on <a href="http://www.angelsoft.net/">AngelSoft&#8217;s new homepage.</a>

A long time ago I created an app that would post messages to the homepage in a ticker when site visitors would do stuff. It was for a liberal political action NGO. From the homepage of this NGO&#8217;s site the ticker would flash messages like &#8220;A member just sent a fax to Senator Jim Webb about Senate Bill 1022&#8221; or &#8220;Bill Jones just became a new member. Welcome Bill!&#8221;

I like how they&#8217;ve taken that concept and put it on a map. Nice.

Funny how we forget cool ideas from long ago. And funny how we forget that there&#8217;s always a chance to build off of old ideas to create newer, better ones. 

Great work, AngelSoft. I expect to see a lot of people follow suit. 
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Filed under: "you gotta be kidding me" -- Patent issued for Page Up Page Down]]></title>
    <link href="http://peteonrails.github.com/blog/2008/08/27/filed-under-you-gotta-be-kidding-me-patent-issued-for-page-up-page-down/"/>
    <updated>2008-08-27T00:00:00-04:00</updated>
    <id>http://peteonrails.github.com/blog/2008/08/27/filed-under-you-gotta-be-kidding-me-patent-issued-for-page-up-page-down</id>
    <content type="html"><![CDATA[Microsoft has been issued a patent on Page-Up/Page-Down functionality (see below). I was annoyed when Amazon patented One-Click-Checkout, but this patent is even more troubling. I have written about Patent craziness before, mostly as it related to &#8220;Submarine Patents&#8221; (i.e. patents for products that will never see the light of day, to the benefit of the patent-holder).

This tactic is somewhat different. It patents an industry standard that has been in effect for a long time. 30 years ago, computers had page-up and page-down keys on their keyboards. It seems a little late to be seeking protection for such an innovation.

Anyone know the prior art backstory here?

From the <a href="http://www.freepatentsonline.com/7415666.html?query=PN%2F7415666+OR+7415666&amp;stemming=on">FreePatentsOnline</a>
<blockquote>A method and system in a document viewer for scrolling a substantially exact increment in a document, such as one page, regardless of whether the zoom is such that some, all or one page is currently being viewed. In one implementation, pressing a Page Down or Page Up keyboard key/button allows a user to begin at any starting vertical location within a page, and navigate to that same location on the next or previous page.

For example, if a user is viewing a page starting in a viewing area from the middle of that page and ending at the bottom, a Page Down command will cause the next page to be shown in the viewing area starting at the middle of the next page and ending at the bottom of the next page. Similar behavior occurs when there is more than one column of pages being displayed in a row.</blockquote>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[New VoteFu Feature: karma counting]]></title>
    <link href="http://peteonrails.github.com/blog/2008/08/22/new-votefu-feature-karma-counting/"/>
    <updated>2008-08-22T00:00:00-04:00</updated>
    <id>http://peteonrails.github.com/blog/2008/08/22/new-votefu-feature-karma-counting</id>
    <content type="html"><![CDATA[I have just introduced the &#8220;has_karma&#8221; mixin to VoteFu. It aims to assign a karma score to the owners of voteable objects. This is designed to allow you to see which users are submitting the most highly voted content. Currently, karma is only &#8220;positive&#8221;. That is, +1 votes add to karma, but -1 votes do not detract from it.
<pre lang="ruby" line="1">class User 
  has_many :posts
  has_karma :posts
end

class Post
  acts_as_voteable
end

# in your view, you can then do this: 
Karma: <%= @user.karma %>
</pre>
This feature is new and probably going to be enhanced significantly, but useful enough that I&#8217;m releasing it now.
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Scrum: Top Ten Signs You're Doing It Wrong]]></title>
    <link href="http://peteonrails.github.com/blog/2008/08/19/scrum-top-ten-signs-youre-doing-it-wrong/"/>
    <updated>2008-08-19T00:00:00-04:00</updated>
    <id>http://peteonrails.github.com/blog/2008/08/19/scrum-top-ten-signs-youre-doing-it-wrong</id>
    <content type="html"><![CDATA[A lot of people are in the business of cataloging &#8220;Scrum Smells&#8221;,  those warning flags that indicate you may have some problems in your agile development process.

These are the ones that I think are important, and common. If these things are happening on your team, <a href="http://punkrockhr.com/?s=DOIN+IT+WRONG">UR DOIN IT WRONG. </a>
<ol>
	<li>Your Burndown Chart does not have an entry on it for every day&#8217;s remaining activity.</li>
	<li>Someone asks you how your sprint velocity is changing over time and you answer, &#8220;It&#8217;s hard to compare sprints, because each one is a different length.&#8221;</li>
	<li>You can&#8217;t tell me when the next Sprint Planning Meeting is, or what was agreed to at the last meeting.</li>
	<li>You have no idea what you&#8217;ll be working on in 4 weeks. Not even a foggy notion.</li>
	<li>When asked if you use scrum, you have to answer, &#8220;We use our own special flavor of scrum.&#8221; Seriously. There isn&#8217;t enough process involved in scrum to have seasonings added to it.</li>
	<li>You are the product owner and the scrum master.</li>
	<li>You are the scrum master and the boss of your scrum team members.</li>
	<li>Your burndown chart goes up sharply at the beginning of each sprint (hint: play planning poker 2 days ahead of the sprint meeting).</li>
	<li>Business stakeholders get mad at the engineering team when their feature isn&#8217;t scheduled for an upcoming milestone (hint: that&#8217;s the product owner&#8217;s baliwick.)</li>
	<li>You have more than 3 or fewer than 1 sprint goals on the board.</li>
</ol>
]]></content>
  </entry>
  
</feed>
